<html>
  <head>
    <script type="text/javascript" src="http://static.admin.zap.com/js/jquery.js"> 
    </script>
  </head>
  <body>

    <script type="text/javascript">
      //var myLoc = KHARMA.getLocation();                                    
      //var myLat = myLoc.latitude;
      //var myLon = myLoc.longitude;

      //function getOffers(){
      var params = {};
      params['latitude'] = 49.115399672969794;
      params['longitude'] = 6.175689243408215;
      params['maxDistance'] = 0; //to be implemented later
      
      var searchterms = {};
      
    
      document.write("myLat: " + params['latitude'] + "<br>"); 
      document.write("myLon: " + params['longitude'] + "<br>"); 

      //build the URL that requests data from getStores.php
      var url= "http://admin.zap.com/getStores.php";
    
      document.write("url: " + url + "<br>"); 
    
      //$.get("admin.zap.com/getStores.php", { latitude: "49.115399672969794", longitude: "6.175689243408215" });

      $.get(url, params, function(xml) //get xml data from getStores.php
      {
          
        $(xml).find('shop').each( function() {
          document.write("Getting Valid Shops"); 
          var name = $(this).children('name').text();
          var pid = $(this).children('publicUid').text(); 
          var ws = $(this).children('webServiceUrl').text(); // ws url of shop
          document.write('<p>ShopName: ' + name + ' PublicUid: ' + pid +' WebServiceUrl: ' + ws + '</p>');
          
          document.write("Retrieving Shop Products <br>");
          // Process ws url and fetch data about products/offers of this shop                    
          $.get(ws, {publicUid: pid}, function(products){ //get xml product data from store ws
            alert(products);
            $(products).find('product').each( function() {
              document.write("Getting Products"); 
              var productname = $(this).children('name').text();
              var price = $(this).children('price').text(); 
              var picture = $(this).children('picture').text(); // ws url!
              // Process ws url and fetch data about products/offers of this shop
              document.write('<p>Product: ' + productname + ' Price: ' + price +' Picture: <img src="' +picture+ '" alt ="No Image"/> </p>');
          
              //use document.createElement();
              });
              
            });
           
          });
        
        
      
        });
      
      
      
        document.write("here1"); 
        //}

    </script> 


    <h1>My First Web Page</h1>
    <p id="demo">This is a paragraph.</p>

    <button type="button" onclick="getOffers()">Get Offers</button>

  </body>
</html>
